# 更新日志 (Changelog)

## [1.2.0] - 2025-10-10

### 新增功能 ✨
- **PNG图像支持**：新增PNG格式图像输入支持
  - 支持8位灰度和RGB PNG图像
  - 自动识别PNG图像类型和位深度
  - **PNG RGB图像直接处理**：保持原始RGB格式，无需通道选择
  - TIFF图像保留通道选择功能（灰度转换/R/G/B）

### 改进 🔧
- 重命名`load_tiff()`为`load_image()`，保留向后兼容
- 重命名`validate_tiff_file()`为`validate_image_file()`，保留向后兼容
- 文件选择对话框增加PNG格式过滤器
- PNG RGB图像禁用通道选择器，显示"PNG彩色图像（无需选择通道）"
- TIFF RGB图像启用通道选择器，支持单通道提取和伪色图
- 更新文档说明PNG和TIFF的不同处理方式

## [1.1.0] - 2025-10-10

### 新增功能 ✨
- **RGB图像支持**：现在支持加载和处理RGB彩色TIFF图像
- **通道选择功能**：为RGB图像提供R/G/B单通道提取
  - 灰度转换：自动转换RGB为灰度图
  - R-红色通道：提取红色通道进行处理
  - G-绿色通道：提取绿色通道进行处理
  - B-蓝色通道：提取蓝色通道进行处理
- **伪色图显示和保存**：提取的R/G/B通道自动生成对应颜色的伪色图
  - R通道 → 红色伪色图（红色通道=灰度值，其余通道=0）
  - G通道 → 绿色伪色图（绿色通道=灰度值，其余通道=0）
  - B通道 → 蓝色伪色图（蓝色通道=灰度值，其余通道=0）
  - 预览和导出均支持伪色图显示
- **自动图像类型识别**：智能识别输入图像是灰度还是RGB
- **通道切换**：加载RGB图像后可以动态切换通道预览

### 改进 🔧
- 优化图像加载逻辑，支持更多图像模式（RGB、RGBA、L、I、I;16）
- 改进16位图像保存，修复"not enough image data"错误
- 增强PNG/TIFF导出，8位/16位位深度转换更准确
- GUI界面增加通道选择下拉框，根据图像类型自动启用/禁用

### 修复 🐛
- 修复16位PNG保存失败的问题（自动转为8位并警告）
- 修复16位TIFF保存时的数据格式错误
- 修复主窗口初始化顺序导致的AttributeError
- 优化8位转换算法，使用实际数据范围归一化

### 技术实现
- `ImageProcessor`类增加RGB图像存储和通道管理
- 新增`_create_pseudocolor_image()`方法生成伪色图
- 新增`get_display_image()`方法获取预览伪色图
- `save_image()`方法增加`use_pseudocolor`参数
- 新增`ProcessingThreadWithChannel`线程类支持通道参数
- 控制面板增加`get_selected_channel()`方法
- 通道映射：0=灰度, 1=R, 2=G, 3=B
- 伪色图采用8位RGB格式，16位通道自动转换为8位RGB

### 使用示例

#### 加载RGB图像
1. 选择RGB TIFF文件
2. 通道选择器自动启用
3. 选择需要的通道（默认灰度转换）
4. 预览并导出

#### 加载灰度图像
- 自动识别为灰度图像
- 通道选择器保持禁用
- 直接预览和导出

---

## [1.0.0] - 2025-10-09

### 首次发布 🎉
- 支持8位和16位灰度TIFF图像
- 最近邻插值像素放大（1-50倍）
- 实时预览和缩放功能
- PNG/TIFF格式导出
- 完整PyQt5 GUI界面
- 内存估算和警告
- 快捷键支持
- 详细日志记录
