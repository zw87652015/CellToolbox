项目：任意张同比例图片的自动拼图工具，至少实现以下功能：
1. 可选单元图尺寸、比例，默认按照输入的图片文件
2. 可选拼图方案，如5*5,6*6,3*8，且支持最后一行不满一行的情况，比如质数张图片
3. 拼图包含编号，编号相对位置同一，且可调整编号位置、字体、大小和形式（1）或①或a
4. 允许输出包含位图和矢量图在内的多种输出格式
5. 可实时预览当前拼图效果

具体细节如下：

0. Before everything
使用PyQt5开发GUI界面，使用Pillow处理图片，使用reportlab生成PDF，使用PyPDF2处理PDF

---

### 1. 输入层  
#### 1.1 图片源  
- 允许用户一次性选择一个 **文件夹** 或 **多选文件**。  
- 只读入 **同宽高比** 的文件；若出现不同比例，弹出二选一：  
  A. 以第一张图为基准，自动裁切后续图中心区域；  
  B. 终止并提示人工处理。  

#### 1.2 元数据缓存  
- 首次读入后，生成 **隐藏缓存文件**（JSON），记录：  
  – 原始路径、分辨率、文件修改时间。  
- 下次启动时秒扫缓存，若文件未变动则秒加载；若变动则局部更新。  

---

### 2. 参数面板（左侧停靠）  
#### 2.1 单元格尺寸  
- 滑块 + 数字框：10–1000 px，步长 10 px。  
- 比例锁定开关：  
  – 开启时，宽高联动，比例始终等于第一张图；  
  – 关闭时，可分别输入宽、高。  
- “还原原始比例”按钮：一键回到 100 % 原始分辨率。  

#### 2.2 拼图方案  
- 下拉菜单：  
  – 预设：5×5、6×6、3×8、4×10、2×20、1×34 …  
  – 自定义：两个数字框 “列数 × 行数”，实时计算所需空位。  
- 智能提示：  
  – 若总图数 ≤ 列数×行数，绿灯“可完整容纳”；  
  – 若不足，黄灯“末行将空出 N 格”，并给出“居中 / 居左 / 分散”三种补空策略。  
- 质数提示：当选中 31、37、41 等质数时，自动推荐“1×N”或最接近的矩形。  

#### 2.3 编号样式  
- 开关：显示编号 / 隐藏编号。  
- 编号形式下拉：1 2 3、① ② ③、a b c、A B C、i ii iii。  
- 编号位置九宫格点选：左上、中上、右上 … 右下。  
- 字体选择器：系统已安装字体列表 + 字号 8–200 px + 颜色拾色器。  
- 边距微调：水平偏移、垂直偏移（-50 px ~ +50 px）。  

#### 2.4 输出格式  
- 多选框：PNG、JPG、TIFF、PDF、SVG、EPS。  
- 分辨率独立设置：72–1200 dpi，仅对位图生效；矢量选项置灰。  
- 文件名模板：支持变量 `{cols}`、`{rows}`、`{width}`、`{height}`、`{datetime}`。  

---

### 3. 实时预览（中央画布）  
#### 3.1 画布规则  
- 背景：中性灰 #eeeeee，可切换 #ffffff 或 #000000 以便检查白边或黑边。  
- 缩放：鼠标滚轮无级缩放，最小 5 %，最大 800 %；左上角显示当前比例。  
- 网格：默认显示淡色虚线，可关闭；悬停单元格高亮边框。  

#### 3.2 编号实时渲染  
- 任何参数改动后 200 ms 内重绘编号，保持字体抗锯齿。  
- 若编号因单元格过小而溢出，出现红色叹号提示“字号过大”。  

#### 3.3 空位示意  
- 末行不足时，用斜线阴影块表示“空白格”，避免用户误以为图丢失。  

#### 3.4 交互  
- 拖拽单图可临时交换位置，仅影响预览顺序，不改变硬盘文件；  
- 右键单图 → “替换为…” 可快速换图并复用参数。  

---

### 4. 输出流程  
#### 4.1 一键导出  
- 按钮文案：“导出拼图”。  
- 弹窗进度条：  
  – 阶段 1：批量缩放图片至目标单元格；  
  – 阶段 2：绘制编号；  
  – 阶段 3：组装画布；  
  – 阶段 4：写入多格式文件。  
- 完成后：  
  – 自动打开目标文件夹；  
  – 生成同名校验 MD5 文本，方便后续核对。  

#### 4.2 日志与回退  
- 每次导出在隐藏目录生成 `log_yyyyMMdd_HHmmss.json`，记录全部参数。  
- 主界面提供“载入历史参数”按钮，可一键回到任意次导出设置。  

---

### 5. 异常与边界  
- 空文件夹：弹窗“未检测到图片”。  
- 图片被占用：重试三次，仍失败则跳过并写入日志。  
- 内存预警：单图大于 50 MB 或总像素大于 1 G 像素时，弹出“可能内存不足，建议先缩图”。  
- 矢量过大：若行列数乘积 > 1000，提示“EPS/SVG 可能生成缓慢，是否继续？”  

---

6. 项目结构
```
multi_image_layout/
├── main.py              ⭐ START HERE
├── requirements.txt     📦 Dependencies
├── README.md           📖 This file
└── ...                 (other modules)
```
